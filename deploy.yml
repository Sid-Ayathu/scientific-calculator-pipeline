---
- name: Deploy Scientific Calculator
  hosts: local
  become: yes
  tasks:
    - name: Pull latest image from Docker Hub
      community.docker.docker_image:
        name: salvoslayer/scientific-calculator:latest
        source: pull

    - name: Stop and remove any existing container
      community.docker.docker_container:
        name: sci_calc_container
        state: absent

    - name: Run new container in background
      community.docker.docker_container:
        name: sci_calc_container
        image: salvoslayer/scientific-calculator:latest
        state: started
        detach: true
        tty: true
        command: tail -f /dev/null   # keeps container running for later CLI access

    - name: Display running containers
      ansible.builtin.shell: docker ps
      register: docker_ps_output

    - name: Show docker ps output
      ansible.builtin.debug:
        var: docker_ps_output.stdout
